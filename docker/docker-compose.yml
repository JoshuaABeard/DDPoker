services:
  ddpoker:
    image: joshuaabeard/ddpoker:3.3.0-CommunityEdition
    build:
      context: ..
      dockerfile: docker/Dockerfile
    ports:
      - "8877:8877"       # pokerserver HTTP API (game client)
      - "8080:8080"       # pokerweb Jetty (website)
      - "11886:11886/udp" # pokerserver UDP (chat)
      - "11889:11889/udp" # pokerserver UDP (connection test)
    volumes:
      - ddpoker_data:/data
    environment:
      # Server URL configuration for installers
      - SERVER_HOST=${SERVER_HOST:-localhost}
      - SERVER_PORT=8877
      - CHAT_PORT=11886
      - WEB_PORT=8080

      # REST API configuration (Phase 1 - Spring Boot API)
      # JWT secret for token signing (minimum 32 characters)
      # Generate with: openssl rand -base64 32
      - JWT_SECRET=${JWT_SECRET:-CHANGE_ME_GENERATE_SECURE_32_CHAR_SECRET}

      # Database configuration (H2 by default)
      # To switch to MySQL, uncomment and configure:
      # - DB_DRIVER=com.mysql.cj.jdbc.Driver
      # - DB_URL=jdbc:mysql://your-mysql-host/poker?useUnicode=true&characterEncoding=UTF8&useSSL=false
      # - DB_USER=poker
      # - DB_PASSWORD=p0k3rdb!

      # Email configuration (optional - required for online profile creation)
      # For Gmail (recommended):
      # 1. Enable 2FA: https://myaccount.google.com/security
      # 2. Generate App Password: https://myaccount.google.com/apppasswords
      # 3. Use the 16-character app password below (not your regular password)
      # - SMTP_HOST=smtp.gmail.com
      # - SMTP_PORT=587
      # - SMTP_USER=your-email@gmail.com
      # - SMTP_PASSWORD=your-16-char-app-password
      # - SMTP_AUTH=true
      # - SMTP_STARTTLS_ENABLE=true
      # - SMTP_FROM=your-email@gmail.com
      #
      # For Outlook/Office 365:
      # - SMTP_HOST=smtp.office365.com
      # - SMTP_PORT=587
      # - SMTP_USER=your-email@outlook.com
      # - SMTP_PASSWORD=your-password
      # - SMTP_AUTH=true
      # - SMTP_STARTTLS_ENABLE=true
      # - SMTP_FROM=your-email@outlook.com

      # Admin user configuration (required for admin panel access)
      # Set these to enable access to /admin pages for managing users and bans
      # - ADMIN_USERNAME=admin
      # - ADMIN_PASSWORD=your-secure-password
    restart: unless-stopped

volumes:
  ddpoker_data:
