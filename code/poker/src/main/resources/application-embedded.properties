# Embedded game server properties (activated with Spring profile "embedded")
# Used when Spring Boot runs inside the desktop client JVM.

# Assign a random available port (resolved at startup; EmbeddedGameServer reads it back)
server.port=0

# Limit concurrent games for local use
game.server.max-concurrent-games=3

# No action timeout for practice games (user plays at their own pace)
game.server.action-timeout-seconds=0

# Delay between AI player actions so humans can observe the game (ms)
game.server.ai-action-delay-ms=400

# File-based H2 database in the user's home directory.
# FILE_LOCK=FS uses filesystem locking released immediately on crash (not socket-based).
# AUTO_RECONNECT=TRUE handles transient connection pool timeouts.
spring.datasource.url=jdbc:h2:file:${user.home}/.ddpoker/games;FILE_LOCK=FS;AUTO_RECONNECT=TRUE
spring.datasource.driver-class-name=org.h2.Driver
spring.jpa.database-platform=org.hibernate.dialect.H2Dialect
spring.jpa.hibernate.ddl-auto=update

# Lazy initialization: Spring beans that access PropertyConfig (loaded by GameEngine.init())
# must not initialize before GameEngine.init() has run.
# EmbeddedGameServer.start() is called after super.init(), so PropertyConfig is ready,
# but lazy-initialization ensures no bean initializes until it is first used.
spring.main.lazy-initialization=true

# RSA key pair paths for JWT auth (generated by EmbeddedGameServer on first startup)
game.server.jwt.private-key-path=${user.home}/.ddpoker/jwt/private-key.pem
game.server.jwt.public-key-path=${user.home}/.ddpoker/jwt/public-key.pem

# Game discovery / cleanup settings
game.server.community-heartbeat-timeout-minutes=5
game.server.lobby-timeout-hours=24
game.server.completed-game-retention-days=7

# Base URL placeholder for SERVER-hosted games.
# EmbeddedGameServer overrides this at runtime with the actual port
# (e.g. ws://localhost:54321) after Spring context starts.
game.server.base-url=ws://localhost
